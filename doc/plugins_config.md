# 配置hekad

### [配置hekad 原文文档](http://hekad.readthedocs.io/en/v0.10.0/config/index.html "配置hekad 原文文档")

### 原文翻译：

### 配置hekad

hekad 配置文件描述了启动时需要装载哪些“输入”、“分割”、“解码”、“过滤”、“编码”和“输出”插件。配置文件为TOML 格式，TOML 和INI 配置格式很相近，但支持更丰富一些的数据结构以及嵌套。

如果hekad 启动时的config 参数设置为一个文件夹路径而不是文件，那么所有该文件夹下以“.toml”为文件名结尾的文件都会被读取并组合成一个配置实例。文件夹中的那些不是以“.toml”结尾的文件则会被忽略。配置文件的合成将按照字母顺序，合并顺序靠后的设置将覆盖考前冲突的设置项生效。

配置文件可以分为多个段落，每个段落是一个独立的插件实例。段落名就是插件的实例名，“type”参数则说明插件的类型；而该类型必须是通过pipeline.RegisterPlugin 方法注册的类型。例如，如下的配置即为一个名称为“tcp:5565”类型为“TcpInput”的Heka 插件，

```
[tcp:5565]
type = "TcpInput"
splitter = "HekaFramingSplitter"
decoder = "ProtobufDecoder"
address = ":5565"
```

如果设置的插件实例名称恰好与插件的类型名称相同，就可以在该段落中省略“type”参数，设置的插件名称也会被作为插件类型。因此，如下的配置中，插件实例名称“TcpInput”，同时也是插件的类型“TcpInput”：

```
[TcpInput]
address = ":5566"
splitter = "HekaFramingSplitter"
decoder = "ProtobufDecoder"
```

注意：只要各自的配置相互间没有干扰，同一个类型的插件可以有多个实例。

配置段落中除了“type”（插件类型）之外的任何值，比如上面示例配置中的“address”（服务地址），将作为内部配置传给插件（见“插件配置”）。

如果插件在启动时装载失败，hekad 将退出启动。当hekad 正在运行时如果插件运行失败（由于连接丢失，无法写文件等），那么hekad 也会关闭或在该插件支持重启的情况下重启插件。当插件重启时，hekad 可能会停止接受消息，直到该插件恢复操作 （仅是对过滤器和输出插件来说）。

插件通过实现Restarting 接口声明他们自身支持重启（见重启插件）。支持重启的插件也可以有空值其自身重启行为的配置。

内部诊断每隔 30秒会扫描消息包，以便在Heka 插件可能出现问题时报告并锁定可能未能正确回收该消息包的具体插件。

### 全局配置项



### 翻译词典：

```
TOML - Github开源项目
```

### [插件与配置](./plugins.md "插件与配置")